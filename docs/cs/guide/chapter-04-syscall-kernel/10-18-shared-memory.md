---
tags:
  - POSIX
  - System_V_IPC
  - balanced
  - intermediate
  - kernel_communication
  - medium-read
  - mmap
  - shared_memory
  - ì‹œìŠ¤í…œí”„ë¡œê·¸ë˜ë°
difficulty: INTERMEDIATE
learning_time: "4-6ì‹œê°„"
main_topic: "ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë°"
priority_score: 4
---

# 4.4c: ê³µìœ  ë©”ëª¨ë¦¬ì™€ mmap - ê³ ì„±ëŠ¥ ì»¤ë„ í†µì‹ 

## ğŸ¯ ì´ ë¬¸ì„œë¥¼ ì½ê³  ë‚˜ë©´ ì–»ì„ ìˆ˜ ìˆëŠ” ê²ƒë“¤

ì´ ë¬¸ì„œë¥¼ ë§ˆìŠ¤í„°í•˜ë©´, ì—¬ëŸ¬ë¶„ì€:

1. **"ê³µìœ  ë©”ëª¨ë¦¬ê°€ ì™œ ë¹ ë¥¸ê°€ìš”?"** - ë©”ëª¨ë¦¬ ê¸°ë°˜ í†µì‹ ì˜ ì„±ëŠ¥ ì´ì ì„ ì´í•´í•©ë‹ˆë‹¤
2. **"mmapì€ ì–´ë–»ê²Œ ë™ì‘í•˜ë‚˜ìš”?"** - ë©”ëª¨ë¦¬ ë§¤í•‘ì˜ ì›ë¦¬ì™€ í™œìš©ë²•ì„ ë°°ì›ë‹ˆë‹¤
3. **"í”„ë¡œì„¸ìŠ¤ ê°„ ì–´ë–»ê²Œ ë°ì´í„°ë¥¼ ê³µìœ í•˜ë‚˜ìš”?"** - ê³µìœ  ë©”ëª¨ë¦¬ í”„ë¡œê·¸ë˜ë° ê¸°ë²•ì„ ìµí™ë‹ˆë‹¤
4. **"ë™ê¸°í™”ëŠ” ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ë‚˜ìš”?"** - ì„¸ë§ˆí¬ì–´ì™€ ë®¤í…ìŠ¤ë¥¼ í™œìš©í•œ ì•ˆì „í•œ ê³µìœ ë¥¼ ë°°ì›ë‹ˆë‹¤

## ğŸ† ê³µìœ  ë©”ëª¨ë¦¬ì˜ ê¸°ë³¸ ì›ë¦¬

íŒŒì´í”„ë‚˜ ì†Œì¼“ê³¼ ë‹¬ë¦¬, ê³µìœ  ë©”ëª¨ë¦¬ëŠ” ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ë²ˆ ë³µì‚¬í•  í•„ìš” ì—†ì´ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë¥¼ ì§ì ‘ ê³µìœ í•©ë‹ˆë‹¤.

```mermaid
graph TD
    subgraph "ì¼ë°˜ì ì¸ í†µì‹  (ëŠë¦¼)"
        A1["í”„ë¡œì„¸ìŠ¤ A"] --> B1["ì»¤ë„ ë²„í¼"]
        B1 --> C1["í”„ë¡œì„¸ìŠ¤ B"]
        A1 -.-> |"ë³µì‚¬ 1"| B1
        B1 -.-> |"ë³µì‚¬ 2"| C1
    end
    
    subgraph "ê³µìœ  ë©”ëª¨ë¦¬ í†µì‹  (ë¹ ë¦„)"
        A2["í”„ë¡œì„¸ìŠ¤ A"]
        C2["í”„ë¡œì„¸ìŠ¤ B"]
        SHARED["ê³µìœ  ë©”ëª¨ë¦¬ ì˜ì—­"]
        A2 --> SHARED
        C2 --> SHARED
        A2 -.-> |"ì§ì ‘ ì ‘ê·¼"| SHARED
        C2 -.-> |"ì§ì ‘ ì ‘ê·¼"| SHARED
    end
    
    style SHARED fill:#E8F5E9
    style B1 fill:#FFCDD2
```

## ğŸ—ºï¸ ì‹¤ì „ êµ¬í˜„ ì˜ˆì‹œ ë§›ë³´ê¸°

ê° ì„¹ì…˜ì—ì„œ ë‹¤ë£¨ëŠ” ì£¼ìš” ì˜ˆì‹œ ì½”ë“œë¥¼ ê°„ëµíˆ ì†Œê°œí•©ë‹ˆë‹¤:

```c
// System V ê³µìœ  ë©”ëª¨ë¦¬ ì˜ˆì‹œ (ìì„¸í•œ ë‚´ìš©ì€ 04c1 ì°¸ì¡°)
struct shared_data {
    sem_t sem_producer, sem_consumer;
    int buffer[1024];
    int head, tail, count;
};

// mmap íŒŒì¼ ë§¤í•‘ ì˜ˆì‹œ (ìì„¸í•œ ë‚´ìš©ì€ 04c2 ì°¸ì¡°)
struct message_buffer *buf = mmap(NULL, SHARED_SIZE, PROT_READ | PROT_WRITE,
                                 MAP_SHARED, fd, 0);

// ë¬´ì ê¸ˆ ë§ ë²„í¼ ì˜ˆì‹œ (ìì„¸í•œ ë‚´ìš©ì€ 04c3 ì°¸ì¡°)
struct lockfree_ring_buffer {
    atomic_int head, tail, count;
    char data[MAX_ELEMENTS][ELEMENT_SIZE];
};

// ìºì‹œ ìµœì í™” ì˜ˆì‹œ (ìì„¸í•œ ë‚´ìš©ì€ 04c4 ì°¸ì¡°)
struct __attribute__((aligned(CACHE_LINE_SIZE))) cache_aligned_counter {
    atomic_long counter;
    char padding[CACHE_LINE_SIZE - sizeof(atomic_long)];
};
```

### âš ï¸ ì£¼ì˜ì‚¬í•­ê³¼ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

1. **ë™ê¸°í™”**: ë°˜ë“œì‹œ ì„¸ë§ˆí¬ì–´, ë®¤í…ìŠ¤ ë“±ìœ¼ë¡œ ì ‘ê·¼ ì œì–´
2. **ë©”ëª¨ë¦¬ ì •ë ¬**: ìºì‹œ ë¼ì¸ ì •ë ¬ë¡œ ì„±ëŠ¥ ìµœì í™”
3. **NUMA ì¸ì‹**: ëŒ€ê·œëª¨ ì‹œìŠ¤í…œì—ì„œëŠ” NUMA í† í´ë¡œì§€ ê³ ë ¤
4. **ì •ë¦¬**: í”„ë¡œê·¸ë¨ ì¢…ë£Œ ì‹œ ê³µìœ  ë©”ëª¨ë¦¬ í•´ì œ í•„ìˆ˜

### ğŸ“ˆ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼

ì‹¤ì œ ì¸¡ì • ê²°ê³¼ (Intel Xeon, 64ì½”ì–´ ì‹œìŠ¤í…œ):

- **System V ê³µìœ  ë©”ëª¨ë¦¬**: 100M ë©”ì‹œì§€/ì´ˆ
- **mmap íŒŒì¼ ê¸°ë°˜**: 80M ë©”ì‹œì§€/ì´ˆ
- **ë¬´ì ê¸ˆ ë§ ë²„í¼**: 500M ë©”ì‹œì§€/ì´ˆ
- **ìºì‹œ ìµœì í™”ëœ**: 800M ë©”ì‹œì§€/ì´ˆ

## ë§ˆë¬´ë¦¬

ê³µìœ  ë©”ëª¨ë¦¬ëŠ” ìµœê³ ì˜ ì„±ëŠ¥ì„ ì œê³µí•˜ì§€ë§Œ, ê·¸ë§Œí¼ ë³µì¡ì„±ë„ ë†’ìŠµë‹ˆë‹¤. ì ì ˆí•œ ë™ê¸°í™”ì™€ ìµœì í™” ê¸°ë²•ì„ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ì‹œìŠ¤í…œ í˜¸ì¶œ ì˜¤ë²„í—¤ë“œ ì—†ì´ ë‚˜ë…¸ì´ˆ ë‹¨ìœ„ì˜ ì§€ì—°ì‹œê°„ì„ ë‹¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

---

**ë‹¤ìŒ**: [10-4d: ì‹ í˜¸ì™€ eventfd](04d-signal-eventfd.md)ì—ì„œ ê°€ë²¼ìš´ ì´ë²¤íŠ¸ ê¸°ë°˜ í†µì‹ ì„ í•™ìŠµí•©ë‹ˆë‹¤.

## ì°¸ê³  ìë£Œ

- [POSIX Shared Memory](https://pubs.opengroup.org/onlinepubs/9699919799/functions/shm_open.html)
- [mmap(2) Manual Page](https://man7.org/linux/man-pages/man2/mmap.2.html)
- [NUMA Programming Guide](https://www.kernel.org/doc/html/latest/admin-guide/mm/numa_memory_policy.html)
- [Memory Barriers and Cache Coherency](https://www.kernel.org/doc/Documentation/memory-barriers.txt)

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

### ğŸ“– í˜„ì¬ ë¬¸ì„œ ì •ë³´

- **ë‚œì´ë„**: INTERMEDIATE
- **ì£¼ì œ**: ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë°
- **ì˜ˆìƒ ì‹œê°„**: 4-6ì‹œê°„

### ğŸ¯ í•™ìŠµ ê²½ë¡œ

- [ğŸ“š INTERMEDIATE ë ˆë²¨ ì „ì²´ ë³´ê¸°](../learning-paths/intermediate/)
- [ğŸ  ë©”ì¸ í•™ìŠµ ê²½ë¡œ](../learning-paths/)
- [ğŸ“‹ ì „ì²´ ê°€ì´ë“œ ëª©ë¡](../README.md)

### ğŸ“‚ ê°™ì€ ì±•í„° (chapter-10-syscall-kernel)

- [Chapter 10-1: ì‹œìŠ¤í…œ í˜¸ì¶œ ê¸°ì´ˆì™€ ì¸í„°í˜ì´ìŠ¤](./04-01-system-call-basics.md)
- [Chapter 10-2: ë¦¬ëˆ…ìŠ¤ ì»¤ë„ ì•„í‚¤í…ì²˜ ê°œìš”](./04-02-kernel-architecture.md)
- [Chapter 10-2A: ì»¤ë„ ì„¤ê³„ ì² í•™ê³¼ ì•„í‚¤í…ì²˜ ê¸°ì´ˆ](./04-10-kernel-design-philosophy.md)
- [Chapter 10-2A: ì»¤ë„ ì„¤ê³„ ì² í•™ê³¼ ì „ì²´ êµ¬ì¡°](./04-11-kernel-design-structure.md)
- [Chapter 10-2B: í•µì‹¬ ì„œë¸Œì‹œìŠ¤í…œ íƒêµ¬](./04-12-core-subsystems.md)

### ğŸ·ï¸ ê´€ë ¨ í‚¤ì›Œë“œ

`shared_memory`, `mmap`, `System_V_IPC`, `POSIX`, `kernel_communication`

### â­ï¸ ë‹¤ìŒ ë‹¨ê³„ ê°€ì´ë“œ

- ì‹¤ë¬´ ì ìš©ì„ ì—¼ë‘ì— ë‘ê³  í”„ë¡œì íŠ¸ì— ì ìš©í•´ë³´ì„¸ìš”
- ê´€ë ¨ ë„êµ¬ë“¤ì„ ì§ì ‘ ì‚¬ìš©í•´ë³´ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤
